name: Setup GitHub Pages

on:
  push:
    branches:
      - main
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  setup-pages:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup GitHub Pages
        uses: actions/github-script@v7
        with:
          script: |
            try {
              const response = await github.rest.repos.getPages({
                owner: context.repo.owner,
                repo: context.repo.repo
              });
              console.log('GitHub Pages is already enabled');
            } catch (error) {
              if (error.status === 404) {
                console.log('Activating GitHub Pages...');
                await github.rest.repos.createPagesSite({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  source: {
                    branch: 'gh-pages',
                    path: '/'
                  }
                });
                console.log('GitHub Pages activated successfully!');
              } else {
                console.log('Error:', error.message);
              }
            }
